<?xml version="1.0" encoding="utf-8" ?>
<mdscript name="KC_Menu" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">

  <!--
  Support for changing keys through a user menu.
  The menu itself will be hardcoded to a specific key combo,
  current ctrl-shift-k.
  
  This makes use of the Simple Menu API.
  -->

  <cues>
  
    <!-- Register default menu-open key with the key capture api. -->
    <cue name="Register_Keys" instantiate="true">
      <conditions>
        <event_cue_signalled cue="md.Key_Capture.Reloaded" />
      </conditions>
      <actions>
        <signal_cue_instantly 
          cue="md.Key_Capture.Register_Key" 
          param="table[$key='ctrl shift k', $cue=Open_Menu]"/>
      </actions>
    </cue>
    
    <!--
    Open a menu for customizing keys.
    Initial version is mostly just for testing.
    -->
    <cue name="Open_Menu" instantiate="true" namespace="this">
      <conditions>
        <event_cue_signalled/>
      </conditions>
      <actions>
        <!-- Create a new blank menu. -->
        <signal_cue_instantly 
          cue="md.Simple_Menu_API.Create_Menu"
          param = "table[
            $columns=5, 
            $title='Key Capture Menu', 
            $callback=Handle_Menu_Action
            ]"/>
            
        <!-- Fill in contents. -->
        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
        <signal_cue_instantly 
          cue="md.Simple_Menu_API.Make_Label"
          param = "table[
            $col=2, 
            $text='Label test', 
            $mouseover='Mouseover test'
            ]"/>
            
        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
        <signal_cue_instantly 
          cue="md.Simple_Menu_API.Make_Label"
          param = "table[
            $col=4, 
            $text='Label test 2', 
            $mouseover='Mouseover test 2'
            ]"/>
            
        
      </actions>
    </cue>

    <!--
    Handle user interaction with the menu.
    TODO: develop.
    -->
    <cue name="Handle_Menu_Action" instantiate="true">
      <conditions>
        <event_cue_signalled />
      </conditions>
      <actions>
        <!-- TODO: do stuff. -->
      </actions>
    </cue>

  </cues>

</mdscript>